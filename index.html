<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- <title>Money Box Tracker</title> -->
  <!-- Primary Meta Tags -->
  <title>Smart Money Box Tracker | Daily Savings Grid Challenge</title>
  <meta name="title" content="Smart Money Box Tracker | Daily Savings Grid Challenge">
  <meta name="description"
    content="Save money daily with a virtual money box inspired by the $10,000 challenge! Custom denominations, auto table, and PDF export. No login needed.">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url"
    content="https://janindu-gaurinda.github.io/Smart-Money-Box---Savings-Tracker-with-PDF-Export/">
  <meta property="og:title" content="Smart Money Box Tracker | Daily Savings Grid Challenge">
  <meta property="og:description"
    content="Track savings using a virtual money box. Customize denominations, save daily, and export reports as PDF. Simple, free, and no login.">
  <meta property="og:image"
    content="https://janindu-gaurinda.github.io/Smart-Money-Box---Savings-Tracker-with-PDF-Export/saving-box">

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:title" content="Smart Money Box Tracker | Daily Savings Grid Challenge">
  <meta property="twitter:description"
    content="Try our browser-based savings box tracker. Save smart with denominations, daily progress and PDF export.">
  <meta property="twitter:image"
    content="https://janindu-gaurinda.github.io/Smart-Money-Box---Savings-Tracker-with-PDF-Export/saving-box.jpg">


  <!-- Structured Data (JSON-LD) -->
  <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "SoftwareApplication",
  "name": "Smart Money Box Tracker",
  "operatingSystem": "Web",
  "applicationCategory": "FinanceApplication",
  "description": "A free and interactive money-saving tracker inspired by the 10,000 dollar challenge box.",
  "url": "https://janindu-gaurinda.github.io/Smart-Money-Box---Savings-Tracker-with-PDF-Export/",
  "image": "https://janindu-gaurinda.github.io/Smart-Money-Box---Savings-Tracker-with-PDF-Export/saving-box.jpg",
  "author": {
    "@type": "Person",
    "name": "Janindu Gaurinda"
  }
}
</script>

  <!-- Keywords -->
  <meta name="keywords"
    content="money box challenge, savings tracker, $10000 challenge, money box grid, smart savings, pdf savings tracker, save money, github money box, virtual piggy bank">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
  <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">

  <style>
    :root {
      --primary-color: #001219;
      --secondary-color: #ffc107;
      --light-bg: #f8f9fa;
    }

    body {
      padding-top: 70px;
      /* background-color: var(--light-bg); */
      background-color: #f8f9fa;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%23001219' fill-opacity='0.03'%3E%3Cpath d='M0 38.59l2.83-2.83 1.41 1.41L1.41 40H0v-1.41zM0 1.4l2.83 2.83 1.41-1.41L1.41 0H0v1.41zM38.59 40l-2.83-2.83 1.41-1.41L40 38.59V40h-1.41zM40 1.41l-2.83 2.83-1.41-1.41L38.59 0H40v1.41zM20 18.6l2.83-2.83 1.41 1.41L21.41 20l2.83 2.83-1.41 1.41L20 21.41l-2.83 2.83-1.41-1.41L18.59 20l-2.83-2.83 1.41-1.41L20 18.59z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .bgcolor_nav {
      background-color: var(--primary-color);
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .form-container {
      background: white;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.05);
      padding: 25px;
      margin-bottom: 30px;
    }

    .bill-options {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 15px 0;
    }

    .bill-option {
      background: #f0f0f0;
      padding: 8px 15px;
      border-radius: 20px;
      transition: all 0.3s;
    }

    .bill-option:hover {
      background: #e0e0e0;
    }

    #output {
      overflow-x: auto;
      margin-top: 30px;
    }

    .tbls_out {
      background-color: white;
      background: white;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.05);
      padding: 25px;
      margin-bottom: 30px;

    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      /* background-color: #f8f9fa; */
    }

    th,
    td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }

    .highlight {
      background-color: #ffff99;
    }

    .suggestion {
      margin-top: 20px;
      padding: 10px;
      background: #f0f0f0;
    }

    .summary-boxes {
      display: flex;
      margin-top: 20px;
      gap: 10px;
    }

    .summary-box {
      border: 1px solid #ccc;
      padding: 10px;
      flex: 1;
      text-align: center;
      background-color: #ffff99;
    }

    .btn-generate {
      background-color: var(--primary-color);
      color: white;
      padding: 10px 25px;
      font-weight: 600;
    }

    .footer {
      background-color: var(--primary-color);
      color: white;
      text-align: center;
      padding: 5px 0;
      margin-top: auto;
    }

    .footer p {
      margin: 0;
      font-size: 0.9rem;
    }

    @media (max-width: 768px) {
      .summary-box {
        min-width: 100%;
      }
    }
  </style>
  <style>
    .swal2-popup.wide-swal-popup {
      width: 600px !important;
      max-width: 95% !important;
      max-height: none !important;
      padding: 20px !important;
      border-radius: 15px !important;
      box-sizing: border-box !important;
      overflow: visible !important;
      /* Remove any scroll */
    }

    .swal2-html-container {
      overflow: visible !important;
      /* No scrolling inside text container */
    }

    .swal2-confirm.custom-ok-btn {
      background-color: #28a745 !important;
      color: white !important;
      font-size: 15px !important;
      padding: 6px 20px !important;
      border-radius: 25px !important;
    }

    .swal2-confirm.custom-ok-btn:hover {
      background-color: #218838 !important;
    }
  </style>
</head>

<body>
  <!-- Navigation -->
  <nav class="navbar navbar-expand-md navbar-dark bgcolor_nav fixed-top">
    <div class="container">
      <span class="navbar-brand mb-0 h1 fw-bold">
        <i class="bi bi-piggy-bank me-2"></i>Money Box Tracker
      </span>
      <!-- <button type="button" class="btn btn-warning btn-lg" onclick="downloadImage()">
        <i class="bi bi-file-image"></i><span class="d-none d-md-inline">Export Image</span>
      </button> -->
       <div id="imageButtonContainer" class="text-center d-none">
          <button class="btn btn-warning btn-sm" onclick="downloadImage()">
        <i class="bi bi-cloud-download-fill"></i> Image
          </button>
        </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="container py-4 flex-grow-1">
    <div class="row justify-content-center">
      <div class="col-lg-10">
        <!-- Form Section -->
        <div class="form-container">
          <h2 class="mb-4 text-center"><i class="bi bi-piggy-bank-fill"></i>Create Your Savings Plan</h2>
          <form id="savingsForm">
            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label fw-bold">Your Name</label>
                <input type="text" class="form-control form-control-lg" id="name" required>
              </div>
              <div class="col-md-6">
                <label class="form-label fw-bold">Start Date</label>
                <input type="date" class="form-control form-control-lg" id="startDate" required>
              </div>
              <div class="col-md-6">
                <label class="form-label fw-bold">Currency</label>
                <select class="form-select form-select-lg" id="currency" onchange="updateDenominations()" required>
                  <option value="">Select Currency</option>
                  <option value="LKR">Sri Lanka (LKR)</option>
                  <option value="INR">India (INR)</option>
                  <option value="JPY">Japan (JPY)</option>
                  <option value="KRW">South Korea (KRW)</option>
                  <option value="USD">United States (USD)</option>
                  <option value="GBP">United Kingdom (GBP)</option>
                  <option value="EUR">Eurozone (EUR)</option>
                  <option value="AUD">Australia (AUD)</option>
                  <option value="CAD">Canada (CAD)</option>
                  <option value="CNY">China (CNY)</option>
                  <option value="RUB">Russia (RUB)</option>
                </select>
              </div>
              <div class="col-md-6">
                <label class="form-label fw-bold">Target Amount (<span id="currencySymbol">LKR</span>)</label>
                <input type="number" class="form-control form-control-lg" id="targetAmount" required min="1">
              </div>
              <div class="col-md-6">
                <label class="form-label fw-bold">Savings Duration (Days)</label>
                <input type="number" class="form-control form-control-lg" id="days" required min="1" max="365">
              </div>
              <div class="col-12">
                <label class="form-label fw-bold">Bill Denominations (<span id="currencySymbol2">LKR</span>)</label>
                <div class="bill-options" id="denominationsContainer">
                  <!-- Denominations will be populated here by JavaScript -->
                </div>
              </div>
              <div class="col-12 text-center mt-3">
                <button type="button" class="btn btn-generate btn-lg" onclick="generateTable()">
                  <i class="bi bi-calculator me-2"></i>Generate Savings Plan
                </button>
              </div>
            </div>
          </form>
        </div>

        <!-- Results Section -->
        <div class="tbls_out" id="output"></div>
        <br>
        <!-- PDF Button (only shown after generation) -->
        <!-- <div id="pdfButtonContainer" class="text-center d-none">
          <button class="btn btn-warning btn-lg" onclick="downloadImage()">
          <i class="bi bi-file-image"></i></i>Download PDF Report
          </button>
        </div> -->
        <!-- <div id="imageButtonContainer" class="text-center d-none">
          <button class="btn btn-warning btn-lg" onclick="downloadImage()">
            <i class="bi bi-file-image"></i></i>Download Plan as Image
          </button>
        </div> -->
        <div id="pdfButtonContainer" class=" text-center d-none">
          <button class="btn btn-warning btn-lg" onclick="downloadPDF()"><i class="bi bi-cloud-download-fill"></i> Download Image</button>
        </div>

        <!-- <div id="imageButtonContainer" class="d-none" >
          <button onclick="downloadImage()">Download Image</button>
        </div> -->

      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <p>¬© Janindu Gaurinda</p>
    </div>
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- Add html2canvas CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <!-- <script>
    const { jsPDF } = window.jspdf;

    // Currency data
    const currencyData = {
      LKR: {
        name: "Sri Lankan Rupee",
        symbol: "LKR",
        denominations: [10, 20, 50, 100, 200, 500, 1000, 2000, 5000]
      },
      INR: {
        name: "Indian Rupee",
        symbol: "INR",
        denominations: [10, 20, 50, 100, 200, 500, 2000]
      },
      JPY: {
        name: "Japanese Yen",
        symbol: "JPY",
        denominations: [1000, 2000, 5000, 10000]
      },
      KRW: {
        name: "South Korean Won",
        symbol: "KRW",
        denominations: [1000, 5000, 10000, 50000]
      },
      USD: {
        name: "US Dollar",
        symbol: "USD",
        denominations: [1, 2, 5, 10, 20, 50, 100]
      },
      GBP: {
        name: "Pound Sterling",
        symbol: "GBP",
        denominations: [5, 10, 20, 50]
      },
      EUR: {
        name: "Euro",
        symbol: "EUR",
        denominations: [5, 10, 20, 50, 100, 200, 500]
      },
      AUD: {
        name: "Australian Dollar",
        symbol: "AUD",
        denominations: [5, 10, 20, 50, 100]
      },
      CAD: {
        name: "Canadian Dollar",
        symbol: "CAD",
        denominations: [5, 10, 20, 50, 100]
      },
      CNY: {
        name: "Chinese Yuan",
        symbol: "CNY",
        denominations: [1, 5, 10, 20, 50, 100]
      },
      RUB: {
        name: "Russian Ruble",
        symbol: "RUB",
        denominations: [10, 50, 100, 200, 500, 1000, 2000, 5000]
      }
    };

    // Update denominations based on selected currency
    function updateDenominations() {
      const currencySelect = document.getElementById('currency');
      const selectedCurrency = currencySelect.value;
      const denominationsContainer = document.getElementById('denominationsContainer');
      const currencySymbol = document.getElementById('currencySymbol');
      const currencySymbol2 = document.getElementById('currencySymbol2');

      denominationsContainer.innerHTML = '';

      if (selectedCurrency && currencyData[selectedCurrency]) {
        const currency = currencyData[selectedCurrency];
        currencySymbol.textContent = currency.symbol;
        currencySymbol2.textContent = currency.symbol;

        currency.denominations.forEach(denomination => {
          const optionId = `bill${denomination}`;

          const optionDiv = document.createElement('div');
          optionDiv.className = 'form-check bill-option';

          optionDiv.innerHTML = `
            <input class="form-check-input" type="checkbox" name="bills" value="${denomination}" id="${optionId}">
            <label class="form-check-label" for="${optionId}">${denomination}</label>
          `;

          denominationsContainer.appendChild(optionDiv);
        });
      } else {
        currencySymbol.textContent = '';
        currencySymbol2.textContent = '';
      }
    }

    function validateInputs() {
      // Get input values
      const name = document.getElementById('name').value.trim();
      const startDateInput = document.getElementById('startDate').value;
      const targetAmountInput = document.getElementById('targetAmount').value;
      const daysInput = document.getElementById('days').value;
      const currency = document.getElementById('currency').value;
      const bills = Array.from(document.querySelectorAll('input[name="bills"]:checked')).map(b => parseInt(b.value));

      // Validate name
      if (!name) {
        alert("Please enter your name.");
        return false;
      }

      // Validate currency
      if (!currency) {
        alert("Please select a currency.");
        return false;
      }

      // Validate date
      if (!startDateInput) {
        alert("Please select a start date.");
        return false;
      }
      const startDate = new Date(startDateInput);
      if (isNaN(startDate.getTime())) {
        alert("Invalid date selected.");
        return false;
      }

      // Validate target amount
      if (!targetAmountInput) {
        alert("Please enter a target amount.");
        return false;
      }
      const targetAmount = parseInt(targetAmountInput);
      if (isNaN(targetAmount)) {
        alert("Target amount must be a valid number.");
        return false;
      }
      if (targetAmount <= 0) {
        alert("Target amount must be greater than 0.");
        return false;
      }

      // Validate days
      if (!daysInput) {
        alert("Please enter number of days.");
        return false;
      }
      const days = parseInt(daysInput);
      if (isNaN(days)) {
        alert("Days must be a valid number.");
        return false;
      }
      if (days < 1) {
        alert("Days must be at least 1.");
        return false;
      }
      if (days > 365) {
        alert("Maximum 365 days allowed.");
        return false;
      }

      // Validate bill selections
      if (bills.length === 0) {
        alert("Select at least one bill denomination.");
        return false;
      }

      return {
        name,
        startDate,
        targetAmount,
        days,
        bills,
        currency
      };
    }

    function generateTable() {
      try {
        // Validate inputs first
        const validated = validateInputs();
        if (!validated) return;

        const { name, startDate, targetAmount, days, bills, currency } = validated;
        const currencyInfo = currencyData[currency] || currencyData.LKR;

        // Dynamically calculate columns based on number of days
        let cols;
        if (days <= 7) {
          cols = days;
        } else if (days <= 30) {
          cols = 7;
        } else if (days <= 90) {
          cols = 10;
        } else {
          cols = 15;
        }

        const rows = Math.ceil(days / cols);

        let totalSaved = 0;
        const tableData = [];

        for (let row = 0; row < rows; row++) {
          let rowData = [];
          for (let col = 0; col < cols; col++) {
            const index = row * cols + col;
            if (index < days) {
              let bill = bills[Math.floor(Math.random() * bills.length)];
              rowData.push(bill);
              totalSaved += bill;
            } else {
              rowData.push('');
            }
          }
          tableData.push(rowData);
        }

        // HTML suggestions
        let suggestions = '';
        const extraAmount = Math.max(0, totalSaved - targetAmount);
        if (totalSaved < targetAmount) {
          const shortBy = targetAmount - totalSaved;
          const extraDaysNeeded = Math.ceil(shortBy / (totalSaved / days));
          const reducedAmount = totalSaved;

          suggestions = `
            <div class="suggestion">
              <h3>Your savings plan falls short by ${currencyInfo.symbol} ${shortBy}</h3>
              <p>Suggestions:</p>
              <p>1. Reduce your target to ${currencyInfo.symbol} ${reducedAmount} (what you'll save in ${days} days)</p>
              <p>2. Increase your timeline to ${days + extraDaysNeeded} days to reach ${currencyInfo.symbol} ${targetAmount}</p>
            </div>
          `;
        }

        // HTML output
        let html = `<h3>Savings Progress for ${name}</h3>`;
        html += `<p>${days} day plan starting ${startDate.toLocaleDateString()}</p>`;
        html += `<p>Currency: ${currency} (${currencyInfo.name})</p>`;
        html += `<table>`;

        tableData.forEach((row, rowIndex) => {
          html += "<tr>";
          row.forEach((col, colIndex) => {
            html += `<td>${col}</td>`;
          });
          html += "</tr>";
        });
        html += "</table>";

        // Summary boxes
        html += `
          <div class="summary-boxes">
            <div class="summary-box">Total: ${currencyInfo.symbol} ${totalSaved}</div>
            <div class="summary-box">Target: ${currencyInfo.symbol} ${targetAmount}</div>
            <div class="summary-box">Remaining: ${currencyInfo.symbol} ${Math.max(0, targetAmount - totalSaved)}</div>
            <div class="summary-box">Extra Amount: ${currencyInfo.symbol} ${extraAmount}</div>
          </div>
        `;

        if (suggestions) html += suggestions;

        document.getElementById('output').innerHTML = html;
        document.getElementById('pdfButtonContainer').classList.remove('d-none');

        // Save data for PDF generation
        window.generatedPDFData = {
          name,
          days,
          tableData,
          targetAmount,
          totalSaved,
          startDate: startDate.toLocaleDateString(),
          cols,
          currency,
          currencyInfo
        };
      } catch (error) {
        console.error("Error generating table:", error);
        alert("An error occurred while generating the table. Please try again.");
      }
    }
 // Download table as PNG/JPG
  function downloadImage() {
    if (!window.generatedImageData) { alert("Please generate a savings plan first!"); return; }
    const outputElement = document.getElementById('output');

    html2canvas(outputElement, { scale: 2, useCORS: true }).then(canvas => {
      const link = document.createElement('a');
      link.href = canvas.toDataURL('image/png');
      link.download = `Savings_Plan_${window.generatedImageData.name.replace(/\s+/g,'_')}.png`;
      link.click();
    }).catch(err => {
      console.error(err);
      alert("Failed to download image. Please try again.");
    });
  }

  // Initialize default currency
  document.addEventListener('DOMContentLoaded', function () {
    updateDenominations();
  });
    document.addEventListener('DOMContentLoaded', function () {
      updateDenominations();
    });
  </script> -->


  <!-- <script>
const { jsPDF } = window.jspdf;

// Currency data
const currencyData = {
  LKR: { name: "Sri Lankan Rupee", symbol: "LKR", denominations: [10, 20, 50, 100, 200, 500, 1000, 2000, 5000] },
  INR: { name: "Indian Rupee", symbol: "INR", denominations: [10, 20, 50, 100, 200, 500, 2000] },
  JPY: { name: "Japanese Yen", symbol: "JPY", denominations: [1000, 2000, 5000, 10000] },
  KRW: { name: "South Korean Won", symbol: "KRW", denominations: [1000, 5000, 10000, 50000] },
  USD: { name: "US Dollar", symbol: "USD", denominations: [1, 2, 5, 10, 20, 50, 100] },
  GBP: { name: "Pound Sterling", symbol: "GBP", denominations: [5, 10, 20, 50] },
  EUR: { name: "Euro", symbol: "EUR", denominations: [5, 10, 20, 50, 100, 200, 500] },
  AUD: { name: "Australian Dollar", symbol: "AUD", denominations: [5, 10, 20, 50, 100] },
  CAD: { name: "Canadian Dollar", symbol: "CAD", denominations: [5, 10, 20, 50, 100] },
  CNY: { name: "Chinese Yuan", symbol: "CNY", denominations: [1, 5, 10, 20, 50, 100] },
  RUB: { name: "Russian Ruble", symbol: "RUB", denominations: [10, 50, 100, 200, 500, 1000, 2000, 5000] }
};

// Update denominations based on selected currency
function updateDenominations() {
  const currencySelect = document.getElementById('currency');
  const selectedCurrency = currencySelect.value;
  const denominationsContainer = document.getElementById('denominationsContainer');
  const currencySymbol = document.getElementById('currencySymbol');
  const currencySymbol2 = document.getElementById('currencySymbol2');

  denominationsContainer.innerHTML = '';

  if (selectedCurrency && currencyData[selectedCurrency]) {
    const currency = currencyData[selectedCurrency];
    currencySymbol.textContent = currency.symbol;
    currencySymbol2.textContent = currency.symbol;

    currency.denominations.forEach(denomination => {
      const optionId = `bill${denomination}`;
      const optionDiv = document.createElement('div');
      optionDiv.className = 'form-check bill-option';
      optionDiv.innerHTML = `
        <input class="form-check-input" type="checkbox" name="bills" value="${denomination}" id="${optionId}">
        <label class="form-check-label" for="${optionId}">${denomination}</label>
      `;
      denominationsContainer.appendChild(optionDiv);
    });
  } else {
    currencySymbol.textContent = '';
    currencySymbol2.textContent = '';
  }
}

function validateInputs() {
  const name = document.getElementById('name').value.trim();
  const startDateInput = document.getElementById('startDate').value;
  const targetAmountInput = document.getElementById('targetAmount').value;
  const daysInput = document.getElementById('days').value;
  const currency = document.getElementById('currency').value;
  const bills = Array.from(document.querySelectorAll('input[name="bills"]:checked')).map(b => parseInt(b.value));

  if (!name) { alert("Please enter your name."); return false; }
  if (!currency) { alert("Please select a currency."); return false; }
  if (!startDateInput) { alert("Please select a start date."); return false; }
  const startDate = new Date(startDateInput);
  if (isNaN(startDate.getTime())) { alert("Invalid date selected."); return false; }
  if (!targetAmountInput) { alert("Please enter a target amount."); return false; }
  const targetAmount = parseInt(targetAmountInput);
  if (isNaN(targetAmount) || targetAmount <= 0) { alert("Target amount must be a valid number > 0."); return false; }
  if (!daysInput) { alert("Please enter number of days."); return false; }
  const days = parseInt(daysInput);
  if (isNaN(days) || days < 1 || days > 365) { alert("Days must be between 1 and 365."); return false; }
  if (bills.length === 0) { alert("Select at least one bill denomination."); return false; }

  return { name, startDate, targetAmount, days, bills, currency };
}

function generateTable() {
  try {
    const validated = validateInputs();
    if (!validated) return;

    const { name, startDate, targetAmount, days, bills, currency } = validated;
    const currencyInfo = currencyData[currency] || currencyData.LKR;

    let cols = days <= 7 ? days : days <= 30 ? 7 : days <= 90 ? 10 : 15;
    const rows = Math.ceil(days / cols);

    let totalSaved = 0;
    const tableData = [];

    for (let row = 0; row < rows; row++) {
      let rowData = [];
      for (let col = 0; col < cols; col++) {
        const index = row * cols + col;
        if (index < days) {
          let bill = bills[Math.floor(Math.random() * bills.length)];
          rowData.push(bill);
          totalSaved += bill;
        } else { rowData.push(''); }
      }
      tableData.push(rowData);
    }

    const extraAmount = Math.max(0, totalSaved - targetAmount);
    let suggestions = '';
    if (totalSaved < targetAmount) {
      const shortBy = targetAmount - totalSaved;
      const extraDaysNeeded = Math.ceil(shortBy / (totalSaved / days));
      const reducedAmount = totalSaved;
      suggestions = `
        <div class="suggestion">
          <h3>Your savings plan falls short by ${currencyInfo.symbol} ${shortBy}</h3>
          <p>1. Reduce target to ${currencyInfo.symbol} ${reducedAmount}</p>
          <p>2. Increase timeline to ${days + extraDaysNeeded} days</p>
        </div>
      `;
    }

    let html = `<h3>Savings Progress for ${name}</h3>`;
    html += `<p>${days} day plan starting ${startDate.toLocaleDateString()}</p>`;
    html += `<p>Currency: ${currency} (${currencyInfo.name})</p>`;
    html += `<table>`;
    tableData.forEach(row => {
      html += "<tr>";
      row.forEach(col => { html += `<td>${col}</td>`; });
      html += "</tr>";
    });
    html += "</table>";
    html += `
      <div class="summary-boxes">
        <div class="summary-box">Total: ${currencyInfo.symbol} ${totalSaved}</div>
        <div class="summary-box">Target: ${currencyInfo.symbol} ${targetAmount}</div>
        <div class="summary-box">Remaining: ${currencyInfo.symbol} ${Math.max(0, targetAmount - totalSaved)}</div>
        <div class="summary-box">Extra Amount: ${currencyInfo.symbol} ${extraAmount}</div>
      </div>
    `;
    if (suggestions) html += suggestions;

    document.getElementById('output').innerHTML = html;
    document.getElementById('pdfButtonContainer').classList.remove('d-none');
    document.getElementById('imageButtonContainer').classList.remove('d-none');

    // Save data for PDF
    window.generatedPDFData = { name, days, tableData, targetAmount, totalSaved, startDate: startDate.toLocaleDateString(), cols, currency, currencyInfo };
    // Save data for image
    window.generatedImageData = { name, startDate: startDate.toLocaleDateString() };

  } catch (error) {
    console.error("Error generating table:", error);
    alert("An error occurred while generating the table. Please try again.");
  }
}

// Download table as PNG
function downloadImage() {
  if (!window.generatedImageData) { alert("Please generate a savings plan first!"); return; }
  const outputElement = document.getElementById('output');
  html2canvas(outputElement, { scale: 2, useCORS: true }).then(canvas => {
    const link = document.createElement('a');
    link.href = canvas.toDataURL('image/png');
    link.download = `Savings_Plan_${window.generatedImageData.name.replace(/\s+/g,'_')}.png`;
    link.click();
  }).catch(err => {
    console.error(err);
    alert("Failed to download image. Please try again.");
  });
}

// Initialize default currency
document.addEventListener('DOMContentLoaded', updateDenominations);
</script> -->
  <script>
    const { jsPDF } = window.jspdf;

    // Currency data
    const currencyData = {
      LKR: { name: "Sri Lankan Rupee", symbol: "LKR", denominations: [10, 20, 50, 100, 200, 500, 1000, 2000, 5000] },
      INR: { name: "Indian Rupee", symbol: "INR", denominations: [10, 20, 50, 100, 200, 500, 2000] },
      JPY: { name: "Japanese Yen", symbol: "JPY", denominations: [1000, 2000, 5000, 10000] },
      KRW: { name: "South Korean Won", symbol: "KRW", denominations: [1000, 5000, 10000, 50000] },
      USD: { name: "US Dollar", symbol: "USD", denominations: [1, 2, 5, 10, 20, 50, 100] },
      GBP: { name: "Pound Sterling", symbol: "GBP", denominations: [5, 10, 20, 50] },
      EUR: { name: "Euro", symbol: "EUR", denominations: [5, 10, 20, 50, 100, 200, 500] },
      AUD: { name: "Australian Dollar", symbol: "AUD", denominations: [5, 10, 20, 50, 100] },
      CAD: { name: "Canadian Dollar", symbol: "CAD", denominations: [5, 10, 20, 50, 100] },
      CNY: { name: "Chinese Yuan", symbol: "CNY", denominations: [1, 5, 10, 20, 50, 100] },
      RUB: { name: "Russian Ruble", symbol: "RUB", denominations: [10, 50, 100, 200, 500, 1000, 2000, 5000] }
    };

    // Update denominations
    function updateDenominations() {
      const currencySelect = document.getElementById('currency');
      const selectedCurrency = currencySelect.value;
      const denominationsContainer = document.getElementById('denominationsContainer');
      const currencySymbol = document.getElementById('currencySymbol');
      const currencySymbol2 = document.getElementById('currencySymbol2');
      denominationsContainer.innerHTML = '';
      if (selectedCurrency && currencyData[selectedCurrency]) {
        const currency = currencyData[selectedCurrency];
        currencySymbol.textContent = currency.symbol;
        currencySymbol2.textContent = currency.symbol;
        currency.denominations.forEach(denomination => {
          const optionId = `bill${denomination}`;
          const optionDiv = document.createElement('div');
          optionDiv.className = 'form-check bill-option';
          optionDiv.innerHTML = `
        <input class="form-check-input" type="checkbox" name="bills" value="${denomination}" id="${optionId}">
        <label class="form-check-label" for="${optionId}">${denomination}</label>
      `;
          denominationsContainer.appendChild(optionDiv);
        });
      } else {
        currencySymbol.textContent = '';
        currencySymbol2.textContent = '';
      }
    }

    function validateInputs() {
      const name = document.getElementById('name').value.trim();
      const startDateInput = document.getElementById('startDate').value;
      const targetAmountInput = document.getElementById('targetAmount').value;
      const daysInput = document.getElementById('days').value;
      const currency = document.getElementById('currency').value;
      const bills = Array.from(document.querySelectorAll('input[name="bills"]:checked')).map(b => parseInt(b.value));
      if (!name) { alert("Please enter your name."); return false; }
      if (!currency) { alert("Please select a currency."); return false; }
      if (!startDateInput) { alert("Please select a start date."); return false; }
      const startDate = new Date(startDateInput);
      if (isNaN(startDate.getTime())) { alert("Invalid date selected."); return false; }
      if (!targetAmountInput) { alert("Please enter a target amount."); return false; }
      const targetAmount = parseInt(targetAmountInput);
      if (isNaN(targetAmount) || targetAmount <= 0) { alert("Target amount must be a valid number > 0."); return false; }
      if (!daysInput) { alert("Please enter number of days."); return false; }
      const days = parseInt(daysInput);
      if (isNaN(days) || days < 1 || days > 365) { alert("Days must be between 1 and 365."); return false; }
      if (bills.length === 0) { alert("Select at least one bill denomination."); return false; }
      return { name, startDate, targetAmount, days, bills, currency };
    }

    function generateTable() {
      try {
        const validated = validateInputs();
        if (!validated) return;
        const { name, startDate, targetAmount, days, bills, currency } = validated;
        const currencyInfo = currencyData[currency] || currencyData.LKR;
        let cols = days <= 7 ? days : days <= 30 ? 7 : days <= 90 ? 10 : 15;
        const rows = Math.ceil(days / cols);
        let totalSaved = 0;
        const tableData = [];
        for (let row = 0; row < rows; row++) {
          let rowData = [];
          for (let col = 0; col < cols; col++) {
            const index = row * cols + col;
            if (index < days) {
              let bill = bills[Math.floor(Math.random() * bills.length)];
              rowData.push(bill);
              totalSaved += bill;
            } else { rowData.push(''); }
          }
          tableData.push(rowData);
        }
        const extraAmount = Math.max(0, totalSaved - targetAmount);
        let suggestions = '';
        if (totalSaved < targetAmount) {
          const shortBy = targetAmount - totalSaved;
          const extraDaysNeeded = Math.ceil(shortBy / (totalSaved / days));
          const reducedAmount = totalSaved;
          suggestions = `
        <div class="suggestion">
          <h3>Your savings plan falls short by ${currencyInfo.symbol} ${shortBy}</h3>
          <p>1. Reduce target to ${currencyInfo.symbol} ${reducedAmount}</p>
          <p>2. Increase timeline to ${days + extraDaysNeeded} days</p>
        </div>
      `;
        }
        let html = `<h3>Savings Progress for ${name}</h3>`;
        html += `<p>${days} day plan starting ${startDate.toLocaleDateString()}</p>`;
        html += `<p>Currency: ${currency} (${currencyInfo.name})</p>`;
        html += `<table>`;
        tableData.forEach(row => { html += "<tr>"; row.forEach(col => { html += `<td>${col}</td>`; }); html += "</tr>"; });
        html += "</table>";
        html += `
      <div class="summary-boxes">
        <div class="summary-box">Total: ${currencyInfo.symbol} ${totalSaved}</div>
        <div class="summary-box">Target: ${currencyInfo.symbol} ${targetAmount}</div>
        <div class="summary-box">Remaining: ${currencyInfo.symbol} ${Math.max(0, targetAmount - totalSaved)}</div>
        <div class="summary-box">Extra Amount: ${currencyInfo.symbol} ${extraAmount}</div>
      </div>
    `;
        if (suggestions) html += suggestions;
        document.getElementById('output').innerHTML = html;
        document.getElementById('pdfButtonContainer').classList.remove('d-none');
        document.getElementById('imageButtonContainer').classList.remove('d-none');

        // Save data for PDF
        window.generatedPDFData = { name, days, tableData, targetAmount, totalSaved, startDate: startDate.toLocaleDateString(), cols, currency, currencyInfo };
        // Save data for Image
        window.generatedImageData = { name, startDate: startDate.toLocaleDateString() };

      } catch (error) {
        console.error("Error generating table:", error);
        alert("An error occurred while generating the table. Please try again.");
      }
    }

    // Download Image
    function downloadImage() {
      if (!window.generatedImageData) { alert("Please generate a savings plan first!"); return; }
      const outputElement = document.getElementById('output');
      html2canvas(outputElement, { scale: 2, useCORS: true }).then(canvas => {
        const link = document.createElement('a');
        link.href = canvas.toDataURL('image/png');
        link.download = `Savings_Plan_${window.generatedImageData.name.replace(/\s+/g, '_')}.png`;
        link.click();
      }).catch(err => {
        console.error(err);
        alert("Failed to download image. Please try again.");
      });
    }

    // Download PDF
    function downloadPDF() {
      if (!window.generatedPDFData) { alert("Please generate a savings plan first!"); return; }
      const data = window.generatedPDFData;
      const doc = new jsPDF();
      doc.text(`Savings Plan for ${data.name}`, 10, 10);
      doc.text(`Days: ${data.days} | Start Date: ${data.startDate}`, 10, 20);
      doc.text(`Target Amount: ${data.currencyInfo.symbol} ${data.targetAmount}`, 10, 30);
      let y = 40;
      data.tableData.forEach(row => {
        doc.text(row.join(' | '), 10, y);
        y += 10;
      });
      doc.save(`Savings_Plan_${data.name.replace(/\s+/g, '_')}.pdf`);
    }

    // Initialize default currency
    document.addEventListener('DOMContentLoaded', updateDenominations);
  </script>

  <!-- ================================================== -->
  <script>
    if (!sessionStorage.getItem('welcomeShown')) {
      Swal.fire({
        title: '<span style="font-size: 22px; font-weight: bold;">Smart Money Box Tracker</span>',
        html: `
        <div style="text-align: left; font-size: 15px; margin-top: 10px;">
          <div style="text-align: center;">
            <img src="saving-box.jpg" alt="Money Box" width="220" style="border-radius: 10px; margin-bottom: 15px; box-shadow: 0 0 10px rgba(0,0,0,0.1);">
          </div>
          <p>
            Inspired by the physical savings challenge box, this is a <strong>digital version</strong> of a customizable tracker. Input your savings goal, pick denominations (like the grid above), and track daily contributions with ease.
          </p>
          <p>
            ‚ú® <strong>Main Features:</strong><br>
            ‚Ä¢ Set savings goal & duration<br>
            ‚Ä¢ Choose bill denominations<br>
            ‚Ä¢ Auto-generate progress table<br>
            ‚Ä¢ Export clean PDF report
          </p>
          <p>
            ‚öôÔ∏è <strong>Benefits:</strong><br>
            ‚Ä¢ No login required ‚Äì browser-based<br>
            ‚Ä¢ Fully client-side (no server)<br>
            ‚Ä¢ Currency and denomination flexibility<br>
            ‚Ä¢ Great for personal finance planning
          </p>
          
          <br>
          <p style="font-size: 14px;">
            üë®‚Äçüíª <strong>Developed by:</strong> Janindu Gaurinda
          </p>
         
          <p>üôè Thank you for visiting!</p>
        </div>
      `,
        icon: 'info',
        confirmButtonText: 'Let‚Äôs Start',
        customClass: {
          popup: 'wide-swal-popup',
          confirmButton: 'custom-ok-btn'
        }
      });

      sessionStorage.setItem('welcomeShown', 'true');
    }
  </script>


</body>

</html>